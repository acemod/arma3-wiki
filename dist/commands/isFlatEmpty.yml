name: isFlatEmpty
description: |-
  Checks given position against given filter params. Filter includes checks for:
  * If there are any objects closer than given distance from given position (in 2D)
  * If the area around position is flat enough to match given gradient
  * If the given position is over water or land
  * If the given position is over shore line
  The gradient seems to correlate with general hill steepness: 0.1 (10%) ~6°, 0.5 (50%) ~27°, 1.0 (100%) ~45°, etc.
  {{Feature | Informative | See also [[BIS_fnc_findSafePos]].}}
problem_notes:
- Objects accounted for proximity check seem to be static objects. Nearby vehicles and units do not seem to affect the output
- Given position will be magically transferred into given position + [[getTerrainHeightASL]] value
- The second element must be -1 (&le; 0 really) at all times, otherwise command becomes unusable
- The command might be a bit heavy on computations so avoid frequent and large area checks
groups:
- Positions
syntax:
- call: !Binary
  - - position
  - - minDistance
    - mode
    - maxGradient
    - maxGradientRadius
    - overLandOrWater
    - shoreLine
    - ignoreObject
  ret:
  - ArrayUnknown
  - Empty array [] if check failed or [[Position#PositionASL|PositionASL]] if succeded. Resulting position will be original [[Position#PositionAGL|PositionAGL]] + [[getTerrainHeightASL]]
  params:
  - name: position
    typ: Position3dASL
  - name: minDistance
    description: (Optional, default -1) minimum (2D) distance from other objects (range 0..50). -1 to ignore proximity check
    typ: Number
  - name: mode
    description: (Optional, default -1) position check mode ('''ALWAYS USE DEFAULT VALUE'''
    typ: Number
  - name: maxGradient
    description: (Optional, default -1) maximum terrain steepness allowed. -1 to ignore
    typ: Number
  - name: maxGradientRadius
    description: (Optional, default 1) how far to extend gradient check
    typ: Number
  - name: overLandOrWater
    description: |-
      (Optional, default 0)
      * 0: position cannot be over water
      * 2: position cannot be over land
      * -1 to ignore
    typ: Number
  - name: shoreLine
    description: |-
      (Optional, default [[false]])
      * [[true]]: position is over shoreline (< ~25 m from water)
      * [[false]] to ignore
    typ: Boolean
  - name: ignoreObject
    description: (Optional, default [[objNull]]) object to ignore in proximity checks. [[objNull]] to ignore
    typ: Object
argument_loc: Unspecified
effect_loc: Unspecified
since:
  arma_2:
    major: 1
    minor: 0
  arma_2_arrowhead:
    major: 1
    minor: 50
  take_on_helicopters:
    major: 1
    minor: 0
  arma_3:
    major: 0
    minor: 50
examples:
- |-
  Check if player position is over land:
  <sqf>_overLand = !(position player isFlatEmpty [-1, -1, -1, -1, 0, false] isEqualTo []);
- |-
  Check if player position is over shore line:
  <sqf>_overShore = !(position player isFlatEmpty  [-1, -1, -1, -1, 0, true] isEqualTo []);
- |-
  Check if player position is over water:
  <sqf>_overWater = !(position player isFlatEmpty  [-1, -1, -1, -1, 2, false] isEqualTo []);
- |-
  Check if no object is closer than 5m to player position:
  <sqf>_isEmpty = !(position player isFlatEmpty  [5, -1, -1, -1, -1, false, player] isEqualTo []);
- |-
  Check if area 10m around player position is relatively flat:
  <sqf>_isFlat = !(position player isFlatEmpty  [-1, -1, 0.3, 10, -1] isEqualTo []);
- |-
  Check if area 15m around player position is very flat and empty:
  <sqf>_isFlatEmpty = !(position player isFlatEmpty  [15, -1, 0.1, 15, -1, false, player] isEqualTo []);
